<!DOCTYPE html>
<html>
  <head>
    <title>D-ID AI Avatar</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;400;700&display=swap" rel="stylesheet" />

    <style>
      .peerConnectionState-new {
        color: cornflowerblue;
      }
      .peerConnectionState-connecting {
        color: orange;
      }
      .peerConnectionState-connected {
        color: green;
      }
      .peerConnectionState-disconnected,
      .peerConnectionState-closed,
      .peerConnectionState-failed {
        color: red;
      }

      .iceConnectionState-new {
        color: cornflowerblue;
      }
      .iceConnectionState-checking {
        color: orange;
      }
      .iceConnectionState-connected,
      .iceConnectionState-completed {
        color: green;
      }
      .peerConnectionState-disconnected,
      .peerConnectionState-closed,
      .peerConnectionState-failed {
        color: red;
      }

      .iceGatheringState-new {
        color: cornflowerblue;
      }
      .iceGatheringState-gathering {
        color: orange;
      }
      .iceGatheringState-complete {
        color: black;
      }

      .signalingState-stable {
        color: green;
      }
      .signalingState-have-local-offer,
      .signalingState-have-remote-offer,
      .signalingState-have-local-pranswer,
      .signalingState-have-remote-pranswer {
        color: cornflowerblue;
      }
      .signalingState-closed {
        color: red;
      }

      .streamingState-streaming {
        color: green;
      }

      .streamingState-empty {
        color: grey;
      }

      .streamEvent-started {
        color: green;
      }

      .streamEvent-done {
        color: orange;
      }

      .streamEvent-ready {
        color: green;
      }

      .streamEvent-error {
        color: red;
      }

      .streamEvent-dont-care {
        color: gray;
      }

      body * {
        font-family: 'Mulish', sans-serif;
        text-align: center;
      }

      #content {
        width: 820px;
        position: relative;
        margin: 0 auto;
      }

      .button-container {
        display: flex;
        flex-direction: row;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
      }

      button {
        padding: 12px 30px;
        border-radius: 5px;
        border: none;
        font-size: 16px;
        background-color: #7459fe;
        color: #fff;
        cursor: pointer;
        transition: all 0.2s ease-out;
      }

      button:hover {
        background-color: #9480ff;
      }

      #destroy-button {
        background-color: #ff4757;
      }

      #destroy-button:hover {
        background-color: #ff6b7a;
      }

      #connection-status {
        margin-top: 20px;
        font-size: 20px;
        font-weight: bold;
        color: #7459fe;
        padding: 10px;
        background-color: #f0f0f0;
        border-radius: 8px;
        display: block;
      }

      #status {
        clear: both;
        padding: 20px 0 0 0;
        text-align: left;
        display: inline-block;
        line-height: 140%;
        font-size: 15px;
      }

      #status div {
        padding-bottom: 10px;
      }

      #video-wrapper {
        background: url(bg.png);
        height: 500px;
        background-position: top;
      }

      #video-wrapper div {
        position: relative;
        height: 100%;
        width: 400px;
        margin: 0 auto;
      }

      video {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border-radius: 50%;
        background-color: #fff;
        object-fit: contain;
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        /* 고정 크기 - 모든 비디오 동일하게 */
        width: 400px !important;
        height: 400px !important;
        /* 시작 화면 배경 이미지 - 비디오 로드 전까지만 보임 */
        background-image: url("my-photo.jpg");
      }
    </style>
  </head>

  <body>
    <div id="content">
      <div id="video-wrapper">
        <div>
          <video id="idle-video-element" autoplay loop style="opacity: 1"></video>
          <video id="stream-video-element" autoplay style="opacity: 0"></video>
        </div>
      </div>
      <br />

      <div class="button-container">
        <button id="mic-button" type="button">🎤 시작</button>
        <button id="destroy-button" type="button">🛑 종료</button>
      </div>

      <div id="connection-status" style="margin-top: 20px; font-size: 18px; color: #7459fe;">
        🔄 연결 중...
      </div>

      <div id="subtitle" style="margin-top: 30px; padding: 15px 30px; background-color: rgba(0, 0, 0, 0.7); color: white; font-size: 18px; border-radius: 10px; min-height: 60px; display: none; line-height: 1.6; text-align: left;">
        <!-- 자막이 여기에 표시됩니다 -->
      </div>
    </div>

    <script type="module" src="./streaming-client-api.js"></script>
  </body>
</html>